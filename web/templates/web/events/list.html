{% extends 'web/_base.html' %}
{% block title %}Events Calendar{% endblock %}
{% block content %}
<div class="container py-4">
    <h1 class="mb-4">Upcoming events</h1>
    
    {% for date, events_on_date in events_by_date.items %}
    <div class="mb-5">
        <h2 class="h4 mb-3">
            {{ date|date:"l, F j" }}
        </h2>
        <div class="list-group">
            {% for event in events_on_date %}
            <a href="{% url 'event_detail' event.id %}" class="list-group-item list-group-item-action flex-column align-items-start">
                <div class="d-flex w-100 justify-content-between">
                    <div>
                        <small class="text-muted text-uppercase">{{ event.program }}</small>
                        <h3 class="h5 mb-1">
                            {% if event.cancelled %}<span class="text-decoration-line-through">{{event.name}}</span> (cancelled){% else %}{{event.name}}{% endif %}
                        </h3>
                    </div>
                </div>
                <div class="mb-1">
                    <small class="text-muted"><i class="bi bi-clock me-1"></i>{{ event.starts_at|date:"g:i A" }}</small>
                    {% if event.location %}
                    <small class="text-muted ms-3"><i class="bi bi-geo-alt me-1"></i>{{ event.location }}</small>
                    {% endif %}
                    {% if not event.external_registration_url %}
                    <small class="text-muted ms-3">
                        <i class="bi bi-people me-1"></i>
                        {{ event.registration_count }} registered{% if not event.has_capacity_available %} (full){% endif %}
                    </small>
                    {% endif %}
                </div>
            </a>
            {% endfor %}
        </div>
    </div>
    {% empty %}
    <div class="text-center py-5">
        <p class="text-muted">No upcoming events scheduled. Check back soon!</p>
    </div>
    {% endfor %}
</div>
{% endblock %}